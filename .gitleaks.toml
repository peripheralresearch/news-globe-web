# Gitleaks configuration for Event Horizon
# Strict allowlist for public Stripe payment links only

title = "Event Horizon Secret Scanning"

[extend]
# Use default rules
useDefault = true

[allowlist]
description = "Allow public Stripe payment links and known false positives"

# CRITICAL: Do NOT exclude .github/ - workflows/configs are common leak sources
paths = [
  '''\.env\.example$''',
  '''node_modules/.*''',
  '''\.next/.*''',
  '''coffee\.png$''',
  # Allow payment links file - public URLs only
  '''payment-links''',
]

# Remove - allowlist.commits requires commit SHAs, not example strings
# commits = []

regexes = [
  # Single precise pattern for public Stripe payment links
  # buy.stripe.com links are public URLs, not secrets
  # Match standard format: 10+ alphanumeric chars
  '''^https://buy\.stripe\.com/[A-Za-z0-9]{10,}$''',
]

# Stopwords for known false positives (case-insensitive)
[allowlist.stops]
stops = [
  '''example''',
  '''placeholder''',
  '''your_.*_here''',
]
