# Gitleaks configuration for Event Horizon
# Strict allowlist for public Stripe payment links only

title = "Event Horizon Secret Scanning"

[extend]
# Use default rules
useDefault = true

[allowlist]
description = "Allow public Stripe payment links and build artifacts only"

# CRITICAL: Do NOT exclude .github/ - workflows/configs are common leak sources
# Only exclude build artifacts and known safe files
paths = [
  '''\.env\.example$''',        # Example env file with placeholders
  '''node_modules/.*''',        # Dependencies (performance)
  '''\.next/.*''',              # Build artifacts (performance)
  '''coffee\.png$''',           # Image file
  '''payment-links''',          # File containing public payment links
]

# Precise regex for public Stripe payment links only
# Format: https://buy.stripe.com/{variable-length alphanumeric ID}
# Stripe payment link IDs are typically 20-30 characters
regexes = [
  '''^https://buy\.stripe\.com/[A-Za-z0-9]{20,30}$''',
]

# Stopwords for known false positives in file content
[allowlist.stops]
stops = [
  '''your_stripe_secret_key_here''',
  '''your_mapbox_token_here''',
  '''your_supabase_url_here''',
  '''example''',
  '''placeholder''',
  '''sk_test_''',  # Allow test mode references in docs
  '''pk_test_''',
]
